!function(e){"use strict";function t(e,t){this.$link=e,this.options=t,this.isPlaying=!1,this.isPlayed=!1,this.totalTime=0,this.fullyLoaded=!1,this.fullTimeDisplayed=!1,this.waitForLoad=!1,this.seekTime=0,this.isPreloaderVisible=!1,this.preloaderTimeout=null,this.isSeeking=!1,this.init()}var n=function(e){var t=Math.round(e)%60,n=(Math.round(e)-t)%3600/60,i=(Math.round(e)-t-60*n)/3600;return(i?i+":":"")+(i&&10>n?"0"+n:n)+":"+(10>t?"0"+t:t)},i=function(e){if("number"==typeof e)return e;for(var t=e.split(":").reverse(),n=0,i=0;i<t.length;i++)n+=t[i]*Math.pow(60,i);return n},o=function(e){return e.preloaderTimeout?e:(e.preloaderTimeout=setTimeout(function(){return e.isSeeking?(e.preloaderTimeout=null,e):(e.isPreloaderVisible=!0,void e.$container.find(".jouele-buffering").addClass("jouele-buffering_visible_true"))},500),e)},a=function(e){return e.preloaderTimeout?(e.isPreloaderVisible=!1,clearTimeout(e.preloaderTimeout),e.preloaderTimeout=null,e.$container.find(".jouele-buffering").removeClass("jouele-buffering_visible_true"),e):e},l=function(e,t){return e.fullyLoaded&&e.totalTime||!e.isPlayed?e:(t.seekPercent>=100?(e.fullyLoaded=!0,e.totalTime=t.duration):e.totalTime=t.seekPercent>0?t.duration:0,e.$container.find(".jouele-load-bar").css({width:Math.floor(Math.min(100,t.seekPercent))+"%"}),e)},s=function(e,t){return e.$container.find(".jouele-play-lift").css("left",t+"%"),e.$container.find(".jouele-play-bar").css("width",t+"%"),e},u=function(e,t){if(e.totalTime<=0&&!e.options.length)return e;var o="";return e.fullyLoaded&&e.totalTime?e.fullTimeDisplayed||(o=n(e.totalTime),e.$container.find(".jouele-total-time").text(o),e.fullTimeDisplayed=!0):e.options.length?(o=n(i(e.options.length)),e.$container.find(".jouele-total-time").text(o)):(o=e.options.length?e.options.length:"~ "+n(e.totalTime),e.$container.find(".jouele-total-time").text(o)),(e.isPlaying||e.waitForLoad)&&(e.totalTime||e.seekTime)&&e.$container.find(".jouele-play-time").text(n(e.seekTime?e.seekTime:t)),e},r=function(e,t){var n=t.toFixed(2);return s(e,n),o(e),e.waitForLoad=!0,e.$jPlayer.jPlayer("playHead",n),e.pseudoPlay(),e.fullTimeDisplayed?(e.seekTime=e.totalTime/100*n,u(e,e.seekTime)):e.options.length&&(e.seekTime=i(e.options.length)/100*n,u(e,e.seekTime)),e};e.fn.jouele=function(n){return this.each(function(){var i=e(this),o=i.data("jouele");o||new t(i,e.extend({},e.fn.jouele.defaults,n,i.data()))})},e.fn.jouele.defaults={swfPath:"./jplayer/",swfFilename:"jplayer.swf",supplied:"mp3",volume:1,length:0,scrollOnSpace:!1,pauseOnSpace:!0,hideTimelineOnPause:!1},t.prototype.init=function(){this.createDOM(),this.initPlayerPlugin(),this.bindEvents(),this.insertDOM()},t.prototype.destroy=function(){var t=this.$container.attr("id");return this.$container.after(this.$link).remove(),e(document).off("."+t),this.$link},t.prototype.pause=function(){return this.waitForLoad=!1,a(this),"undefined"!=typeof this.$jPlayer&&this.$jPlayer.jPlayer&&this.isPlaying&&this.$jPlayer.jPlayer("pause"),this.isPlaying||this.pseudoPause(),this},t.prototype.pseudoPause=function(){this.$container.removeClass("jouele-status-playing"),this.$container.find(".jouele-play").removeClass("jouele-hidden"),this.$container.find(".jouele-pause").addClass("jouele-hidden")},t.prototype.stop=function(){return"undefined"!=typeof this.$jPlayer&&this.$jPlayer.jPlayer&&this.isPlaying&&this.$jPlayer.jPlayer("stop"),this},t.prototype.play=function(){return o(this),"undefined"!=typeof this.$jPlayer&&this.$jPlayer.jPlayer&&(this.isPlaying||this.$jPlayer.jPlayer("play")),this},t.prototype.pseudoPlay=function(){e(document).trigger("jouele-pause",this),this.$container.addClass("jouele-status-playing"),this.$container.find(".jouele-pause").removeClass("jouele-hidden"),this.$container.find(".jouele-play").addClass("jouele-hidden")},t.prototype.onPause=function(){this.isPlaying=!1,this.$container.removeClass("jouele-status-playing"),this.$container.find(".jouele-play").removeClass("jouele-hidden"),this.$container.find(".jouele-pause").addClass("jouele-hidden")},t.prototype.onStop=function(){this.isPlaying=!1,this.$container.removeClass("jouele-status-playing")},t.prototype.onPlay=function(){e(document).trigger("jouele-pause",this),this.$container.addClass("jouele-status-playing"),this.$container.find(".jouele-pause").removeClass("jouele-hidden"),this.$container.find(".jouele-play").addClass("jouele-hidden"),this.isPlaying=!0,this.isPlayed=!0},t.prototype.createDOM=function(){var t=e(document.createElement("div")),n=e(document.createElement("div")),i=e(document.createElement("div")),o=e(document.createElement("div")),a=this.$link.text(),l=this,s=function(){return[e(document.createElement("div")).addClass("jouele-time").append(e(document.createElement("div")).addClass("jouele-play-time").text(l.options.length?"0:00":""),e(document.createElement("div")).addClass("jouele-total-time").text(l.options.length?l.options.length:"")),e(document.createElement("div")).addClass("jouele-control").append(e(document.createElement("div")).addClass("jouele-play-control").append(e(document.createElement("div")).addClass("jouele-unavailable"),e(document.createElement("a")).attr("href",l.$link.attr("href")).addClass("jouele-play-pause jouele-hidden").append(e(document.createElement("span")).addClass("jouele-play"),e(document.createElement("span")).addClass("jouele-pause jouele-hidden"))),e(document.createElement("div")).addClass("jouele-control-text").html(a))]},u=function(){return e(document.createElement("div")).addClass("jouele-mine").append(e(document.createElement("div")).addClass("jouele-mine-bar"),e(document.createElement("div")).addClass("jouele-load-bar jouele-hidden"),e(document.createElement("div")).addClass("jouele-play-bar"),e(document.createElement("div")).addClass("jouele-play-lift jouele-hidden").append(e(document.createElement("div")).addClass("jouele-buffering")))};return this.$container=t.data("jouele",this).addClass("jouele"+(this.options.hideTimelineOnPause?" jouele_timeline_hide":"")).attr("id","jouele-ui-zone-"+(1e3+Math.round(8999*Math.random()))).append(n.addClass("jouele-invisible-object"),i.addClass("jouele-info-area").append(s()),o.addClass("jouele-progress-area").append(u())),this},t.prototype.initPlayerPlugin=function(){var t=this,n=t.$container.find(".jouele-invisible-object");return this.$jPlayer=n.jPlayer({solution:"html,flash",preload:"metadata",errorAlerts:!1,swfPath:t.options.swfPath+t.options.swfFilename,supplied:t.options.supplied,volume:t.options.volume,ready:function(){var i=t.$link.attr("href"),a=t.$container.attr("id");n.jPlayer("setMedia",{mp3:i}),t.$container.find(".jouele-hidden").removeClass("jouele-hidden"),t.$container.find(".jouele-unavailable").addClass("jouele-hidden"),t.$container.find(".jouele-pause").addClass("jouele-hidden"),t.$container.find(".jouele-play-pause").on("click",function(e){e.preventDefault(),e.stopPropagation()}),t.$container.find(".jouele-play").on("click",function(){t.pseudoPlay.call(t),t.play.call(t)}),t.$container.find(".jouele-pause").on("click",function(){t.pseudoPause.call(t),t.pause.call(t)}),t.$container.find(".jouele-mine").on("mousedown."+a,function(n){if(1!==n.which)return!1;n.stopPropagation(),n.preventDefault(),t.isSeeking=!0;var i=e(this),l=(n.pageX-i.offset().left)/i.width()*100;e(document).off("mouseup."+a).on("mouseup."+a,function(){t.isSeeking=!1,o(t)}),e(document).off("mousemove."+a).on("mousemove."+a,function(e){if(e.stopPropagation(),e.preventDefault(),!t.isSeeking)return!1;var n=(e.pageX-i.offset().left)/i.width()*100;r(t,n)}),r(t,l)})},pause:function(){t.onPause.call(t)},stop:function(){t.onStop.call(t)},play:function(){t.onPlay.call(t)},progress:function(e){l(t,e.jPlayer.status),u(t,e.jPlayer.status.currentTime)},timeupdate:function(e){l(t,e.jPlayer.status),u(t,e.jPlayer.status.currentTime),s(t,e.jPlayer.status.currentPercentAbsolute.toFixed(2)),t.isPreloaderVisible&&a(t),t.waitForLoad&&(t.waitForLoad=!1,t.seekTime=0,t.play(),a(t))}}),this},t.prototype.insertDOM=function(){return this.$link.after(this.$container),this.$link.detach(),this},t.prototype.bindEvents=function(){var t=this,n=t.$container.attr("id");return e(document).on("jouele-pause."+n,function(e,n){t!==n&&t.pause()}),e(document).on("keydown."+n,function(e){32===e.keyCode&&t.isPlaying&&t.options.pauseOnSpace&&(t.options.scrollOnSpace||(e.stopPropagation(),e.preventDefault()),t.$jPlayer.jPlayer("pause"))}),this};var d=function(){e(".jouele").jouele()};e(d)}(jQuery);