!function(e){"use strict";function t(e,t){this.$link=e,this.options=t,this.isPlaying=!1,this.isPlayed=!1,this.totalTime=0,this.fullyLoaded=!1,this.fullTimeDisplayed=!1,this.waitForLoad=!1,this.seekTime=0,this.isPreloaderVisible=!1,this.preloaderTimeout=null,this.isSeeking=!1,this.init()}var n=!1,i=function(){var e=document.createElement("div");return e.innerHTML="<svg/>","http://www.w3.org/2000/svg"==(e.firstChild&&e.firstChild.namespaceURI)},o=function(){return("object"==typeof Modernizr&&"boolean"==typeof Modernizr.inlinesvg&&Modernizr.inlinesvg||i())&&(n=!0),this},a=function(e){var t=Math.round(e)%60,n=(Math.round(e)-t)%3600/60,i=(Math.round(e)-t-60*n)/3600;return(i?i+":":"")+(i&&10>n?"0"+n:n)+":"+(10>t?"0"+t:t)},l=function(e){if("number"==typeof e)return e;for(var t=e.split(":").reverse(),n=0,i=0;i<t.length;i++)n+=t[i]*Math.pow(60,i);return n},s=function(e){return e.preloaderTimeout?e:(e.preloaderTimeout=setTimeout(function(){return e.isSeeking?(e.preloaderTimeout=null,e):(e.isPreloaderVisible=!0,void e.$container.find(".jouele-buffering").addClass("jouele-buffering_visible_true"))},500),e)},r=function(e){return e.preloaderTimeout?(e.isPreloaderVisible=!1,clearTimeout(e.preloaderTimeout),e.preloaderTimeout=null,e.$container.find(".jouele-buffering").removeClass("jouele-buffering_visible_true"),e):e},u=function(e,t){return e.fullyLoaded&&e.totalTime||!e.isPlayed?e:(t.seekPercent>=100?(e.fullyLoaded=!0,e.totalTime=t.duration):t.seekPercent>0?e.totalTime=t.duration:e.totalTime=0,e.$container.find(".jouele-load-bar").css({width:Math.floor(Math.min(100,t.seekPercent))+"%"}),e)},d=function(e,t){return e.$container.find(".jouele-play-lift").css("left",t+"%"),e.$container.find(".jouele-play-bar").css("width",t+"%"),e},p=function(e,t){if(e.totalTime<=0&&!e.options.length)return e;var n="";return e.fullyLoaded&&e.totalTime?e.fullTimeDisplayed||(n=a(e.totalTime),e.$container.find(".jouele-total-time").text(n),e.fullTimeDisplayed=!0):e.options.length?(n=a(l(e.options.length)),e.$container.find(".jouele-total-time").text(n)):(n=e.options.length?e.options.length:"~ "+a(e.totalTime),e.$container.find(".jouele-total-time").text(n)),(e.isPlaying||e.waitForLoad)&&(e.totalTime||e.seekTime)&&e.$container.find(".jouele-play-time").text(a(e.seekTime?e.seekTime:t)),e},c=function(e,t){var n=t.toFixed(2);return d(e,n),s(e),e.waitForLoad=!0,e.$jPlayer.jPlayer("playHead",n),e.pseudoPlay(),e.fullTimeDisplayed?(e.seekTime=e.totalTime/100*n,p(e,e.seekTime)):e.options.length&&(e.seekTime=l(e.options.length)/100*n,p(e,e.seekTime)),e};e.fn.jouele=function(n){return this.each(function(){var i=e(this),o=i.data("jouele");o||new t(i,e.extend({},e.fn.jouele.defaults,n,i.data()))})},e.fn.jouele.defaults={swfPath:"./jplayer/",swfFilename:"jplayer.swf",supplied:"mp3",volume:1,length:0,scrollOnSpace:!1,pauseOnSpace:!0,hideTimelineOnPause:!1},t.prototype.init=function(){this.createDOM(),this.initPlayerPlugin(),this.bindEvents(),this.insertDOM()},t.prototype.destroy=function(){var t=this.$container.attr("id");return this.$container.after(this.$link).remove(),e(document).off("."+t),this.$link},t.prototype.pause=function(){return this.waitForLoad=!1,r(this),"undefined"!=typeof this.$jPlayer&&this.$jPlayer.jPlayer&&this.isPlaying&&this.$jPlayer.jPlayer("pause"),this.isPlaying||this.pseudoPause(),this},t.prototype.pseudoPause=function(){this.$container.removeClass("jouele-status-playing"),this.$container.find(".jouele-play").removeClass("jouele-hidden"),this.$container.find(".jouele-pause").addClass("jouele-hidden")},t.prototype.stop=function(){return"undefined"!=typeof this.$jPlayer&&this.$jPlayer.jPlayer&&this.isPlaying&&this.$jPlayer.jPlayer("stop"),this},t.prototype.play=function(){return s(this),"undefined"!=typeof this.$jPlayer&&this.$jPlayer.jPlayer&&(this.isPlaying||this.$jPlayer.jPlayer("play")),this},t.prototype.pseudoPlay=function(){e(document).trigger("jouele-pause",this),this.$container.addClass("jouele-status-playing"),this.$container.find(".jouele-pause").removeClass("jouele-hidden"),this.$container.find(".jouele-play").addClass("jouele-hidden")},t.prototype.onPause=function(){this.isPlaying=!1,this.$container.removeClass("jouele-status-playing"),this.$container.find(".jouele-play").removeClass("jouele-hidden"),this.$container.find(".jouele-pause").addClass("jouele-hidden")},t.prototype.onStop=function(){this.isPlaying=!1,this.$container.removeClass("jouele-status-playing")},t.prototype.onPlay=function(){e(document).trigger("jouele-pause",this),this.$container.addClass("jouele-status-playing"),this.$container.find(".jouele-pause").removeClass("jouele-hidden"),this.$container.find(".jouele-play").addClass("jouele-hidden"),this.isPlaying=!0,this.isPlayed=!0},t.prototype.createDOM=function(){var t=e(document.createElement("div")),i=e(document.createElement("div")),o=e(document.createElement("div")),a=e(document.createElement("div")),l=this.$link.text(),s=this,r=function(){return[e(document.createElement("div")).addClass("jouele-time").append(e(document.createElement("div")).addClass("jouele-play-time").text(s.options.length?"0:00":""),e(document.createElement("div")).addClass("jouele-total-time").text(s.options.length?s.options.length:"")),e(document.createElement("div")).addClass("jouele-control").append(e(document.createElement("div")).addClass("jouele-play-control").append(e(document.createElement("div")).addClass("jouele-unavailable").html(n?'<svg class="jouele-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" enable-background="new 0 0 16 16"><g fill="#fff"><path opacity=".5" d="m4 7.7l3.8 3.7-3.8 2.1z"/><path opacity=".5" d="m.2 3.2l.6-.5 11 11.1-.5.5z"/><path opacity=".5" d="m4 5.3v-.8l8 4.5-2.7 1.5z"/></g><g class="jouele-svg-color"><path d="m4 6.7l3.8 3.7-3.8 2.1z"/><path d="m.2 2.2l.6-.5 11 11.1-.5.5z"/><path d="m4 4.3v-.8l8 4.5-2.7 1.5z"/></g></svg>':""),e(document.createElement("a")).attr("href",s.$link.attr("href")).addClass("jouele-play-pause jouele-hidden").append(e(document.createElement("span")).addClass("jouele-play").html(n?'<svg class="jouele-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" enable-background="new 0 0 16 16"><path opacity=".5" fill="#fff" d="m4 4.5l8 4.5-8 4.5z"/><path class="jouele-svg-color" d="m4 3.5l8 4.5-8 4.5z"/></svg>':""),e(document.createElement("span")).addClass("jouele-pause jouele-hidden").html(n?'<svg class="jouele-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" enable-background="new 0 0 16 16"><path opacity=".5" fill="#fff" d="m4 4.5l8 4.5-8 4.5z"/><path class="jouele-svg-color" d="m4 3.5l8 4.5-8 4.5z"/></svg>':""))),e(document.createElement("div")).addClass("jouele-control-text").html(l))]},u=function(){return e(document.createElement("div")).addClass("jouele-mine").append(e(document.createElement("div")).addClass("jouele-mine-bar"),e(document.createElement("div")).addClass("jouele-load-bar jouele-hidden"),e(document.createElement("div")).addClass("jouele-play-bar"),e(document.createElement("div")).addClass("jouele-play-lift jouele-hidden").append(e(document.createElement("div")).addClass("jouele-buffering")))};return this.$container=t.data("jouele",this).addClass("jouele"+(this.options.hideTimelineOnPause?" jouele_timeline_hide":"")).attr("id","jouele-ui-zone-"+(1e3+Math.round(8999*Math.random()))).append(i.addClass("jouele-invisible-object"),o.addClass("jouele-info-area").append(r()),a.addClass("jouele-progress-area").append(u())),this},t.prototype.initPlayerPlugin=function(){var t=this,n=t.$container.find(".jouele-invisible-object");return this.$jPlayer=n.jPlayer({solution:"html,flash",preload:"metadata",errorAlerts:!1,swfPath:t.options.swfPath+t.options.swfFilename,supplied:t.options.supplied,volume:t.options.volume,ready:function(){var i=t.$link.attr("href"),o=t.$container.attr("id");n.jPlayer("setMedia",{mp3:i}),t.$container.find(".jouele-hidden").removeClass("jouele-hidden"),t.$container.find(".jouele-unavailable").addClass("jouele-hidden"),t.$container.find(".jouele-pause").addClass("jouele-hidden"),t.$container.find(".jouele-play-pause").on("click",function(e){e.preventDefault(),e.stopPropagation()}),t.$container.find(".jouele-play").on("click",function(){t.pseudoPlay.call(t),t.play.call(t)}),t.$container.find(".jouele-pause").on("click",function(){t.pseudoPause.call(t),t.pause.call(t)}),t.$container.find(".jouele-mine").on("mousedown."+o,function(n){if(1!==n.which)return!1;n.stopPropagation(),n.preventDefault(),t.isSeeking=!0;var i=e(this),a=(n.pageX-i.offset().left)/i.width()*100;e(document).off("mouseup."+o).on("mouseup."+o,function(){t.isSeeking=!1,s(t)}),e(document).off("mousemove."+o).on("mousemove."+o,function(e){if(e.stopPropagation(),e.preventDefault(),!t.isSeeking)return!1;var n=(e.pageX-i.offset().left)/i.width()*100;c(t,n)}),c(t,a)})},pause:function(){t.onPause.call(t)},stop:function(){t.onStop.call(t)},play:function(){t.onPlay.call(t)},progress:function(e){u(t,e.jPlayer.status),p(t,e.jPlayer.status.currentTime)},timeupdate:function(e){u(t,e.jPlayer.status),p(t,e.jPlayer.status.currentTime),d(t,e.jPlayer.status.currentPercentAbsolute.toFixed(2)),t.isPreloaderVisible&&r(t),t.waitForLoad&&(t.waitForLoad=!1,t.seekTime=0,t.play(),r(t))}}),this},t.prototype.insertDOM=function(){return this.$link.after(this.$container),this.$link.detach(),this},t.prototype.bindEvents=function(){var t=this,n=t.$container.attr("id");return e(document).on("jouele-pause."+n,function(e,n){t!==n&&t.pause()}),e(document).on("keydown."+n,function(e){32===e.keyCode&&t.isPlaying&&t.options.pauseOnSpace&&(t.options.scrollOnSpace||(e.stopPropagation(),e.preventDefault()),t.$jPlayer.jPlayer("pause"))}),this},o();var f=function(){e(".jouele").jouele()};e(f)}(jQuery);